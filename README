
NOTE: This program is a work in progress. Don't expect it to work yet.

License: GPLv3

mdnssd-mini is a minimal client for mDNS and DNS-SD that is designed to do only the following:

  1. Use DNS-SD over mDNS to search for a specified service type on one interface.

  2. Use mDNS to resolve the IP addresses for all results returned by the DNS-SD query.

In other words, it returns the hostname, IP and port for each instance of a service of a specified type running on connected LANs.

Example usage:

./mdnssd _workstation._tcp.local

There are some things that this program should do, according to RFC 6762 and 6763, that it does not do, such as, but not limited to:

  1. It does not care about TTL at all, so:
    a. No expiration of cached results.
    b. No re-sending of a query after TTL expiration.

  2. It completely ignores negative responses.

  3. It never sends any Known-Answer records.

  4. It only works with multicast queries and responses.

  5. It only supports IPv4

ToDo:

  1. Support waiting for a certain minimum number of results to arrive.

  2. Fix memory leaks.

  3. Add IPv6 support

  4. Implement continuous operation support.
     Cache queries until TTL experies. 

  5. Add TXT record support.
     
  6. Implement unicast reply support.


Alternatives available on OpenWRT:

  Use mdns-utils:
    These are example applications developed by Apple and are extremely limited.
    We encountered problems working with these tools from lua without requiring
    more than lua's built-in popen and execute calls.

  Use bind-dig:
    This only works for mDNS, not for DNS-SD, and requires bind-libs which has
    an ipk size of 768 kB.

  Use avahi-utils:
    This depends on dbus, libdbus, libavahi and avahi-daemon, which together 
    take up over 500 kB as ipks.


Note: The priority and weight fields of SRV records are not reported.